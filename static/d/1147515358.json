{"data":{"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"Site"},"id":"796f9c65-8fdb-5ebc-9914-491a8a83cf76","html":"<p>Connecting to a SharePoint Site</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> spql <span class=\"token keyword\">from</span> <span class=\"token string\">'spql'</span>\n\n<span class=\"token keyword\">const</span> SPSite <span class=\"token operator\">=</span> spql<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>getListCollectionInfo</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">getListCollectionInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Array>} The Site's List Info {id, name, siteUrl, description, createdBy, created, modified, itemCount, defaultViewUrl, isDocumentList, isHidden}</span></code></pre></div>\n<h2>uploadDocument</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">uploadDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  fileStream<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>Bytes<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  fileName<span class=\"token punctuation\">:</span> String<span class=\"token punctuation\">,</span>\n  destination<span class=\"token punctuation\">:</span> String<span class=\"token punctuation\">,</span>\n  fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>Field<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Object>} Results {isSuccess, error}</span></code></pre></div>\n<p>Uploads a document to a document libary under the site.</p>\n<p><strong>Field</strong></p>\n<p>{displayName, staticName, type, value}</p>\n<h2>getUserById</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">getUserById</span><span class=\"token punctuation\">(</span>UserID<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;?Object>} The User {id, account, displayName, email}</span></code></pre></div>\n<h2>getCurrentUser</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;?Object>} The Current User {id, account, displayName, email}</span></code></pre></div>\n<h2>getGroupsFromUser</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">getGroupsFromUser</span><span class=\"token punctuation\">(</span>userLoginName<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Array>} The User's Groups {id, name, description}</span></code></pre></div>\n<h2>getUsersInGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">getUsersInGroup</span><span class=\"token punctuation\">(</span>groupName<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Array>} The Users in Group {id, account, displayName, email}</span></code></pre></div>\n<h2>createGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">createGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">,</span>\n  description<span class=\"token punctuation\">,</span>\n  ownerLoginName<span class=\"token punctuation\">,</span>\n  ownerIsGroup<span class=\"token punctuation\">,</span>\n  defaultUserLoginName\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Object>} Results {isSuccess, error}</span></code></pre></div>\n<h2>deleteGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">deleteGroup</span><span class=\"token punctuation\">(</span>groupName<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Object>} Results {isSuccess, error}</span></code></pre></div>\n<h2>addUsersToGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">addUserToGroup</span><span class=\"token punctuation\">(</span>groupName<span class=\"token punctuation\">,</span> userLoginName<span class=\"token operator\">|</span><span class=\"token punctuation\">[</span>userLoginName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Object>} Results {isSuccess, error}</span></code></pre></div>\n<h2>deleteUsersFromGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">deleteUserFromGroup</span><span class=\"token punctuation\">(</span>groupName<span class=\"token punctuation\">,</span> userLoginName<span class=\"token operator\">|</span><span class=\"token punctuation\">[</span>userLoginName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;Object>} Results {isSuccess, error}</span></code></pre></div>\n<h2>isUserInGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">isUserInGroup</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> groupId<span class=\"token operator\">|</span><span class=\"token punctuation\">[</span>groupId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;boolean>}</span></code></pre></div>\n<h2>isCurrentUserInGroup</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">SPSite<span class=\"token punctuation\">.</span><span class=\"token function\">isCurrentUserInGroup</span><span class=\"token punctuation\">(</span>groupId<span class=\"token operator\">|</span><span class=\"token punctuation\">[</span>groupId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// => {Promise,&lt;boolean>}</span></code></pre></div>"}}]}}}